package com.industry.rx_epl.operators.internals;

using com.apama.exceptions.Exception;

event PluckMapper {
	any fieldName;
	
	static action create(any fieldName) returns action<any> returns any {
		return PluckMapper(fieldName).pluck;
	}
	
	action pluck(any value) returns any {
		try {
			return value.getEntry(fieldName);
		} catch (Exception e) {
			throw Exception("Can't pluck " + fieldName.valueToString() + ", value does not have the field", "InvalidOperation");
		}
	}
}