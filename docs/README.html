<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RxEPL</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#rxepl---observables-in-epl">RxEPL - Observables in EPL</a>
<ul>
<li><a href="#contents">Contents</a></li>
<li><a href="#a-idinstallainstallation">Installation</a></li>
<li><a href="#a-idquickaquickstart">Quickstart</a></li>
<li><a href="#a-idintroareactivex-an-introduction">ReactiveX: an Introduction</a></li>
<li><a href="#a-idpackagesapackage-structure">Package Structure</a></li>
<li><a href="#a-idexamplesaexamples">Examples</a></li>
<li><a href="#a-idobservableaobservable">Observable</a></li>
<li><a href="#a-idcombiningajoining-and-combining">Joining and Combining</a></li>
<li><a href="#a-iderrorsaerror-handling">Error Handling</a></li>
<li><a href="#a-idinteropainteroperability">Interoperability</a></li>
<li><a href="#multithreading">Multithreading</a></li>
<li><a href="#a-idmulticastingapublishing-and-sharing">Publishing and Sharing</a></li>
<li><a href="#a-idsubjectasubject">Subject</a></li>
<li><a href="#a-iddebuggingadebugging">Debugging</a></li>
<li><a href="#a-idreusabilityareusability-build-your-own-observable-operator">Reusability: Build your own Observable Operator</a></li>
<li><a href="#a-idgotchasagotchas">Gotchas</a></li>
<li><a href="#a-idotherahelp-and-other-resources">Help and Other Resources</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="rxepl---observables-in-epl">RxEPL - Observables in EPL</h1>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#install">Installation</a></li>
<li><a href="#quick">Quickstart</a></li>
<li><a href="#intro">Introduction to ReactiveX and Observables</a></li>
<li>Main
<ul>
<li><a href="#packages">Package Structure</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#observable">Observable</a>
<ul>
<li><a href="#observable-construction">Creating</a></li>
<li><a href="#subscribing">Subscribing</a></li>
<li><a href="#operators">Operators</a></li>
<li><a href="#combining">Joining &amp; Combining</a></li>
<li><a href="#errors">Error Handling</a></li>
<li><a href="#multicasting">Publishing/Sharing and Multicasting</a></li>
</ul>
</li>
<li><a href="#subject">Subject</a>
<ul>
<li><a href="#subject-types">Types</a></li>
<li><a href="#subject-construction">Creating</a></li>
<li><a href="#subject-sending">Sending Data</a></li>
</ul>
</li>
<li><a href="#interop">Interoperability</a>
<ul>
<li><a href="#streams">Streams</a></li>
<li><a href="#channels">Channels</a></li>
</ul>
</li>
<li><a href="#multithreading">Multithreading</a></li>
<li><a href="#debugging">Debugging</a></li>
<li><a href="#reusability">Reusability: Build your own Operator</a></li>
</ul>
</li>
<li><a href="#gotchas">Gotchas</a>
<ul>
<li><a href="#gotcha-multiple-subscribers">Multiple Subscribers</a></li>
<li><a href="#gotcha-subscribe-on">Publish/Share with SubscribeOn</a></li>
</ul>
</li>
<li><a href="#other">Help and Other Resources</a></li>
</ul>
<h2 id="a-idinstallainstallation"><a id="install"></a>Installation</h2>
<p>The deployment script provides a way to make ReactiveX for EPL (RxEPL) globally available to all SoftwareAG Designer workspaces.</p>
<h3 id="installing-into-designer">1. Installing into Designer</h3>
<ol>
<li>Place the RxEPL folder somewhere safe (somewhere not likely to be moved or deleted)</li>
<li>Run the deploy.bat</li>
<li>Follow the instructions</li>
<li>Restart any running instances of SoftwareAG Designer</li>
</ol>
<h3 id="adding-to-a-project">2. Adding to a Project</h3>
<ol>
<li>From SoftwareAG Designer right click on your project in <code>Project Explorer</code></li>
<li>Select <code>Apama</code> from the drop down menu;</li>
<li>Select <code>Add Bundle</code></li>
<li>Scroll down to <code>Standard bundles</code> and select <code>RxEpl</code></li>
<li>Click <code>Ok</code></li>
</ol>
<p>When run via Designer, it will automatically inject all of the dependencies.</p>
<h3 id="packaging-a-project-for-use-outside-designer">3. Packaging a project (For use outside Designer)</h3>
<p>The Apama tool <code>engine_deploy</code> packages a project so that it can be run outside of designer.</p>
<ol>
<li>Start an Apama Command Prompt (Start menu, Software AG, Tools, Apama, Apama Command Prompt)</li>
<li><code>cd</code> to your project directory</li>
<li>Run <code>engine_deploy --outputDeployDir output.zip . &lt;rx_epl_install_dir&gt;/rxepl.properties</code>.<br>
You’ll end up with a zip of your entire project.</li>
<li>Unzip it on whichever machine you’d like to use the project.</li>
<li>Run <code>correlator --config initialization.yaml --config initialization.properties</code> from within the unzipped directory to run the project.</li>
</ol>
<h2 id="a-idquickaquickstart"><a id="quick"></a>Quickstart</h2>
<p>Aimed at those who are too <s>lazy</s> busy  to read the rest of the Docs.</p>
<ol>
<li>First check out the <a href="#install">Installation Instructions</a>, steps 1 &amp; 2.</li>
<li>Grab the ‘Lambdas for Epl’ package and install that too.</li>
<li>Start Software AG Designer.</li>
<li>Copy the following code into a new file: “main.mon”</li>
</ol>
<pre class=" language-javascript"><code class="prism  language-javascript">using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>lambdas<span class="token punctuation">.</span>Lambda<span class="token punctuation">;</span>

using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>Observable<span class="token punctuation">;</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>IObservable<span class="token punctuation">;</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>Subscriber<span class="token punctuation">;</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>ISubscription<span class="token punctuation">;</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>IDisposable<span class="token punctuation">;</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>WrappedAny<span class="token punctuation">;</span>

monitor Main <span class="token punctuation">{</span>
	action <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Some example observables sources</span>
		IObservable someValues <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromValues</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		IObservable someValuesFromAChannel <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromChannel</span><span class="token punctuation">(</span><span class="token string">"inputChannel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">// Some observable operators</span>
		IObservable someModifiedValues <span class="token punctuation">:</span><span class="token operator">=</span> someValues
			<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Lambda<span class="token punctuation">.</span><span class="token function">function1</span><span class="token punctuation">(</span><span class="token string">"x =&gt; x * 10"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span>Lambda<span class="token punctuation">.</span><span class="token function">function2</span><span class="token punctuation">(</span><span class="token string">"sum, x =&gt; sum + x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// Some output</span>
		ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> someModifiedValues
			<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>logValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	action <span class="token function">logValue</span><span class="token punctuation">(</span>any value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		log value<span class="token punctuation">.</span><span class="token function">valueToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ol start="4">
<li>Run the project.</li>
<li>(Optional) Read the rest of the instructions to learn how to use the library.</li>
</ol>
<h2 id="a-idintroareactivex-an-introduction"><a id="intro"></a>ReactiveX: an Introduction</h2>
<p>ReactiveX is a framework designed to handle streams of data like water through pipes. It has libraries which implement the framework in <a href="http://reactivex.io/languages.html">most</a> major programming languages.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable temperatureBreaches <span class="token punctuation">:</span><span class="token operator">=</span> 
    Observable<span class="token punctuation">.</span><span class="token function">fromChannel</span><span class="token punctuation">(</span><span class="token string">"TemperatureSensor"</span><span class="token punctuation">)</span> <span class="token comment">// Get all of the events being sent to this channel</span>
              <span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">)</span>             <span class="token comment">// Get the temperature value</span>
              <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>aboveThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// Filter to only the temperatures we want</span>
              
<span class="token comment">// Generate an alert</span>
ISubscription generateAlerts <span class="token punctuation">:</span><span class="token operator">=</span> temperatureBreaches<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>generateAlert<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre>
<p>Features:</p>
<ul>
<li>Functional Programming</li>
<li><a href="#operators">Chainable Operators</a> (without “callback hell”!)</li>
<li><a href="#errors">Error handling</a></li>
<li><a href="#multithreading">“Easy” multithreading</a></li>
</ul>
<p>For a comprehensive introduction to ReactiveX and Observables see the <a href="http://reactivex.io/intro.html">ReactiveX Website</a>.</p>
<h2 id="a-idpackagesapackage-structure"><a id="packages"></a>Package Structure</h2>
<p><strong>Interfaces:</strong><br>
<code>com.industry.rx_epl.IObservable</code> - The main observable interface, returned after calling an operator or constructor (See <a href="#observable">Observable</a>)<br>
<code>com.industry.rx_epl.ISubject</code> - The subject interface, returned from construction of a subject (see <a href="#subject">Subject</a>)<br>
<code>com.industry.rx_epl.ISubscription</code> - Returned by <code>.subscribe()</code> allows unsubscription<br>
<code>com.industry.rx_epl.IDisposable</code> - Sometimes a listener has to be created that this library doesn’t know when to tear down, in that case it returns an <code>IDisposable</code> and should be torn down by the user if/when all subscribers are done (see <a href="#multithreading">Multithreading</a>)<br>
<code>com.industry.rx_epl.IResolver</code> - Similar to a subject has next, error, complete methods. Used in <a href="#observable-construction">Observable.create(…)</a></p>
<p><strong>Constructors:</strong><br>
<code>com.industry.rx_epl.Observable</code> - The event from which to construct an IObservable (See <a href="#observable">Observable</a>)<br>
<code>com.industry.rx_epl.Subject</code> - A simple subject, allowing next, error, complete events to be sent  (see <a href="#subject">Subject</a>)<br>
<code>com.industry.rx_epl.BehaviourSubject</code> - A subject that always repeats the most recent value to a new subscriber (see <a href="#subject">Subject</a>)<br>
<code>com.industry.rx_epl.Subscriber</code> - A subscriber. Defines handling for onNext, onError, onComplete (see <a href="#subscribing">Subscribing</a>)</p>
<p><strong>Operators:</strong><br>
<code>com.industry.rx_epl.operators.*</code> - All pipeable operators (See <a href="#operators">Operators</a>. The ApamaDoc contains a full list)</p>
<h2 id="a-idexamplesaexamples"><a id="examples"></a>Examples</h2>
<p>There are several examples that ship with the source code. These are located in the <code>Examples</code> folder.</p>
<h2 id="a-idobservableaobservable"><a id="observable"></a>Observable</h2>
<h3 id="a-idobservable-constructionaconstructing-an-observable"><a id="observable-construction"></a>Constructing an Observable</h3>
<p>Creating an Observable is usually the starting point of an Observable chain (See also: <a href="#subject">Subject</a>)</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromValues</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span> <span class="token string">"World"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromChannel</span><span class="token punctuation">(</span><span class="token string">"MyChannel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromStream</span><span class="token punctuation">(</span><span class="token keyword">from</span> e <span class="token keyword">in</span> all <span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span> select <span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>generator<span class="token punctuation">)</span><span class="token punctuation">;</span>

action <span class="token function">generator</span><span class="token punctuation">(</span>IResolver r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    r<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="a-idsubscribingasubscribing---receiving-data"><a id="subscribing"></a>Subscribing - Receiving data</h3>
<p>Subscribing is the main way to extract information from an observable pipe.<br>
<strong>Important To Note:</strong> Every subscriber gets it’s own pipe to the observable source so operators are run once per subscription. To avoid this use <a href="#multicasting">publish or share</a>.</p>
<p><strong>onNext</strong> - Used to get every data point from the pipe</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>

action <span class="token function">printValue</span><span class="token punctuation">(</span>any value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    print value<span class="token punctuation">.</span><span class="token function">valueToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>onComplete</strong> - Called when the pipe is closing (not all observables complete)</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printDone<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: Hello World, Done</span>

action <span class="token function">printDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    print <span class="token string">"Done"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>onError</strong> - Called when the pipe is closing due to an error</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: com.apama.exceptions.Exception(...)</span>

action <span class="token function">printError</span><span class="token punctuation">(</span>any e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    print e<span class="token punctuation">.</span><span class="token function">valueToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="a-idoperatorsaoperators"><a id="operators"></a>Operators</h3>
<p>All of the built-in operators are accessible directly from the IObservable interface:</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printDone<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 1, 2, 3, Done</span>
</code></pre>
<p>They are also accessible via a “pure function” pipe, and can then be combined with custom operators:</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>
                           <span class="token punctuation">.</span><span class="token keyword">let</span><span class="token punctuation">(</span>Skip<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// Use a single operator</span>
                           <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>                 <span class="token comment">// Chain multiple operators</span>
                                Take<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                Map<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                MyCustomOperator<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">123.4</span><span class="token punctuation">)</span>
                            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printDone<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 1, 2, 3, Done</span>
</code></pre>
<p>Which you choose to use is up to you.</p>
<p>There are far too many operators to go through every one here, but there is a really handy decision tree in the <a href="#other">external links section</a> to help you find the one you need. The ApamaDoc lists all of the operators.</p>
<h2 id="a-idcombiningajoining-and-combining"><a id="combining"></a>Joining and Combining</h2>
<p><strong>Merge</strong> - Combine all values from multiple observables onto one observable</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o1 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IObservable o2 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

IObservable combined <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">[</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 0, 1, 2, 1, 3, 2, 4...</span>
</code></pre>
<p><strong>Concat</strong> - Append the values from one observable to the values from another</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o1 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IObservable o2 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

IObservable combined <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 0, 1, 2...</span>
</code></pre>
<p><strong>CombineLatest</strong> - Every time an event is received combine it with the latest from every other observable</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o1 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IObservable o2 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

IObservable combined <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">combineLatest</span><span class="token punctuation">(</span><span class="token punctuation">[</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">]</span><span class="token punctuation">,</span> toIntSequence<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: [0,0], [1,0], [2,0], [2,1]...</span>
<span class="token comment">// @Time:  1.0  , 2.0  , 3.0  , 3.0</span>
</code></pre>
<p><strong>WithLatestFrom</strong> - Every time an event is receive on the main observable combine it with the latest from every other observable</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o1 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IObservable o2 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

IObservable combined <span class="token punctuation">:</span><span class="token operator">=</span> o1<span class="token punctuation">.</span><span class="token function">withLatestFrom</span><span class="token punctuation">(</span><span class="token punctuation">[</span>o2<span class="token punctuation">]</span><span class="token punctuation">,</span> toIntSequence<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: [1,0], [2,1], [2,1]...</span>
<span class="token comment">// @Time:  2.0  , 3.0  , 4.0</span>
</code></pre>
<p><strong>Zip</strong> - Sequentially combine each event with an event from every other observable</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o1 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IObservable o2 <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

IObservable combined <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">]</span><span class="token punctuation">,</span> toIntSequence<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: [0,0], [1,1], [2,2], [3,3]...</span>
<span class="token comment">// @Time:  1.5  , 3.0  , 4.5  , 6.0</span>
</code></pre>
<h2 id="a-iderrorsaerror-handling"><a id="errors"></a>Error Handling</h2>
<p>Observables handle errors in almost exactly the same they handle “complete” events. They are passed along the chain of observers until they are handled. If they are not handled by the final subscriber then the subscriber will throw an exception.</p>
<h3 id="subscriber.onerror">Subscriber.onError</h3>
<p>Subscribing to the error output of an observable allows a subscriber to manually handle errors</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

action <span class="token function">printError</span><span class="token punctuation">(</span>any e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log e<span class="token punctuation">.</span><span class="token function">valueToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> at ERROR<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="iobservable.catcherror">IObservable.catchError</h3>
<p>Catching errors allows an observable chain to substitute an alternative observable source in the event of an error.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o<span class="token punctuation">;</span> <span class="token comment">// = 0, 1, Error</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o 
                    <span class="token punctuation">.</span><span class="token function">catchError</span><span class="token punctuation">(</span>Observable<span class="token punctuation">.</span><span class="token function">just</span><span class="token punctuation">(</span><span class="token string">"Use this instead"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, Use this instead</span>
</code></pre>
<h3 id="iobservable.retry">IObservable.retry</h3>
<p>Retry instructs the observable to reconnect to the source in the event of an error.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable hotObservable<span class="token punctuation">;</span> <span class="token comment">// = 0, 1, Error, 2, 3</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> hotObservable 
                    <span class="token punctuation">.</span><span class="token function">retry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                         <span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span>
                                         <span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span>
                                         <span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printComplete<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3</span>
</code></pre>
<h2 id="a-idinteropainteroperability"><a id="interop"></a>Interoperability</h2>
<h3 id="a-idstreamsastreams"><a id="streams"></a>Streams</h3>
<p><strong>Receiving from a stream</strong></p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Receiving events </span>
IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromStream</span><span class="token punctuation">(</span><span class="token keyword">from</span> e <span class="token keyword">in</span> all <span class="token function">MyEventType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> select <span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Receiving values</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>WrappedAny<span class="token punctuation">;</span>
IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromStream</span><span class="token punctuation">(</span><span class="token keyword">from</span> e <span class="token keyword">in</span> all <span class="token function">WrappedAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span> select e<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Output to a stream</strong></p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

DisposableStream strm <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">toStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">from</span> value <span class="token keyword">in</span> strm<span class="token punctuation">.</span><span class="token function">getStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> select value <span class="token punctuation">{</span>
    log value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// When done, the stream should be disposed</span>
strm<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="a-idchannelsachannels"><a id="channels"></a>Channels</h3>
<p><strong>Receiving from a channel</strong></p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Receiving events </span>
IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">fromChannel</span><span class="token punctuation">(</span><span class="token string">"myChannel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

send <span class="token function">MyEvent</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span> to <span class="token string">"myChannel"</span><span class="token punctuation">;</span>

<span class="token comment">// Values sent in a WrappedAny are automatically unwrapped</span>
using com<span class="token punctuation">.</span>industry<span class="token punctuation">.</span>rx_epl<span class="token punctuation">.</span>WrappedAny<span class="token punctuation">;</span>
send <span class="token function">WrappedAny</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span> to <span class="token string">"myChannel"</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>Output to a channel</strong></p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Subscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>sendToChannel<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

action <span class="token function">sendToChannel</span><span class="token punctuation">(</span>any value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    send value to <span class="token string">"myChannel"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="multithreading">Multithreading</h2>
<p>Multithreading allows complex or slow processing to be handled asynchronously on a different context.</p>
<h3 id="observeon">observeOn</h3>
<p>Observe on is useful when you want the subscription and some of the processing to be done on a different thread. The connection to the original observable is still done on the main context and all data is forwarded to the other context.</p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Ideally should dispose of this when the spawned context is done processing (if ever)</span>
IDisposable d <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observeOnNew</span><span class="token punctuation">(</span>doSomething<span class="token punctuation">)</span><span class="token punctuation">;</span>

action <span class="token function">doSomething</span><span class="token punctuation">(</span>IObservable source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// This part will run on a different context</span>
    ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Output from "A specific context": 0, 1, 2, 3</span>
</code></pre>
<h3 id="observetochannel-observefromchannel">observeToChannel, observeFromChannel</h3>
<p>ObserveToChannel and ObserveFromChannel are useful for sending data between different monitor instances which may or may not be on different contexts.</p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Ideally should dispose of this when all subscribers are finished (if ever)</span>
IDisposable d <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observeToChannel</span><span class="token punctuation">(</span><span class="token string">"channelName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This could be in a different monitor</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">observeFromChannel</span><span class="token punctuation">(</span><span class="token string">"channelName"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3</span>
</code></pre>
<h3 id="pipeon">pipeOn</h3>
<p>PipeOn allows part of the processing in a chain to be done on a different context. Data is received on the main context, forwarded to another context for processing, and finally forwarded back to the main context for subscription.</p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Values start on the main context</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
                            <span class="token comment">// Send to a different context to do the heavy lifting</span>
                            <span class="token punctuation">.</span><span class="token function">pipeOnNew</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Map<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// Back on the main context for the output</span>
                            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 10, 20, 30...</span>
</code></pre>
<h3 id="complexpipeon">complexPipeOn</h3>
<p>Much the same as PipeOn, ComplexPipeOn allows part of an observable chain to be processed on a separate context.</p>
<pre class=" language-javascript"><code class="prism  language-javascript"><span class="token comment">// Values start on the main context</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
                            <span class="token comment">// Send to a different context to do the heavy lifting</span>
                            <span class="token punctuation">.</span><span class="token function">complexPipeOnNew</span><span class="token punctuation">(</span>doSomething<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">// Back on the main context for the output</span>
                            <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            
action <span class="token function">doSomething</span><span class="token punctuation">(</span>IObservable o<span class="token punctuation">)</span> returns IObservable <span class="token punctuation">{</span>
    <span class="token keyword">return</span> o<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Output: 0, 10, 20, 30...</span>
</code></pre>
<h3 id="subscribeon">subscribeOn</h3>
<p>SubscribeOn will move an entire chain (from source to subscription) onto another context. There are a couple of <a href="#gotchas">Gotchas</a> with this when used with publishing and sharing.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
                             <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span>
                             <span class="token comment">// Move all processing to a different context </span>
                             <span class="token comment">// (including the .map and the observable source)</span>
                             <span class="token punctuation">.</span><span class="token function">subscribeOnNew</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                                              <span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output from "A specific context": 0, 10, 20, 30...</span>
</code></pre>
<h2 id="a-idmulticastingapublishing-and-sharing"><a id="multicasting"></a>Publishing and Sharing</h2>
<p>Publishing and Sharing are methods of converting an Observable a multicast emitter.</p>
<p>By default when a normal observable is subscribed to an entirely new processing chain is created (one for each subscriber), this can result in some unexpected behaviour:</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 0, 1, 2, 3...  What?!</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The first subscriber creates it’s own interval, and so does the second one. These are not linked.</p>
<h3 id="publish">Publish</h3>
<p>Publish allows a single observable subscription to be shared among various other subscribers. The upstream subscription is only created when connect is called so downstreams will not receive values until then.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
IDisposable d <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 2, 3... Connected 2s after .connect() was called so missed 2 values</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 0, 1, 2, 3...</span>
    IDisposable d <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="a-idrefcountapublish-refcount"><a id="refcount"></a>Publish RefCount</h3>
<p>Manually connecting to a published observable can be a pain. RefCount will automatically connect to a published observable when the first subscriber subscribes. It keeps a count of the number of subscribers so that when the count drops to zero it can disconnect. A subscription after disconnection will result in a re-connection.<br>
publish().refCount() is so common that it has a shorthand <a href="#share">.share()</a></p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// can be replaced with .share()</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 2, 3...</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="a-idshareashare"><a id="share"></a>Share</h3>
<p>Share is a shorthand for <a href="#refcount">.publish().refCount()</a>.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0, 1, 2, 3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 2, 3...</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="a-idsubjectasubject"><a id="subject"></a>Subject</h2>
<p>Subjects are just like channels in EPL in that they are a multicast way to send messages to all subscribers. Usually any late subscribers miss the messages. There are a few different types of subject that have various different behaviours.</p>
<h3 id="a-idsubject-typesatypes"><a id="subject-types"></a>Types</h3>
<p><strong>Subject</strong> - A normal subject, sends messages to all subscribers<br>
<strong>BehaviourSubject</strong> - A subject that always has a current value and sends this to new subscribers.<br>
<strong>ReplaySubject</strong> - Replays a certain number of missed values to new subscribers.</p>
<h3 id="a-idsubject-constructionaconstructing-a-subject"><a id="subject-construction"></a>Constructing a Subject</h3>
<p>Creating a Subject is an alternative way to start an Observable chain (See also: <a href="#observable">Observable</a>)</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubject s <span class="token punctuation">:</span><span class="token operator">=</span> Subject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         s <span class="token punctuation">:</span><span class="token operator">=</span> BehaviourSubject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"InitialValue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         s <span class="token punctuation">:</span><span class="token operator">=</span> ReplaySubject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="a-idsubject-sendingasending-data"><a id="subject-sending"></a>Sending Data</h3>
<p><strong>next(any value)</strong> - Send the next value to be processed</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubject subject <span class="token punctuation">:</span><span class="token operator">=</span> Subject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 1</span>
</code></pre>
<p><strong>complete()</strong> - Close the pipe</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubject subject <span class="token punctuation">:</span><span class="token operator">=</span> Subject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printDone<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 1, Done</span>
</code></pre>
<p><strong>error(any error)</strong> - Send an error and close the pipe</p>
<pre class=" language-javascript"><code class="prism  language-javascript">ISubject subject <span class="token punctuation">:</span><span class="token operator">=</span> Subject<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

subject<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"An error occurred"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: An error occurred</span>
</code></pre>
<h2 id="a-iddebuggingadebugging"><a id="debugging"></a>Debugging</h2>
<h3 id="do">do</h3>
<p>Do is a handy operator that allows you to inspect the values as they pass through a chain of observables. It is like a subscriber except that it is passive, only receiving messages when someone is subscribed further down the chain.</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s <span class="token punctuation">:</span><span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">.</span><span class="token keyword">do</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                  <span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span>
                                  <span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span>
                                  <span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printComplete<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>multiplyBy10<span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                          <span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span>
                                          <span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>printError<span class="token punctuation">)</span>
                                          <span class="token punctuation">.</span><span class="token function">onComplete</span><span class="token punctuation">(</span>printComplete<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output from Do: 0, 1, 2, 3, 4, Done</span>
<span class="token comment">// Output from Subscriber: 0, 10, 20, 30, 40, Done</span>
</code></pre>
<h2 id="a-idreusabilityareusability-build-your-own-observable-operator"><a id="reusability"></a>Reusability: Build your own Observable Operator</h2>
<p>Lets say you have the following:</p>
<pre class=" language-javascript"><code class="prism  language-javascript">observable
   <span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">)</span>
   <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>aboveThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>but you want it to be reusable.</p>
<p>There are several options:</p>
<h3 id="option-1-wrap-into-an-action---good">Option 1: Wrap into an action - Good</h3>
<pre class=" language-javascript"><code class="prism  language-javascript">action <span class="token function">tempTooHigh</span><span class="token punctuation">(</span>IObservable source<span class="token punctuation">)</span> returns IObservable <span class="token punctuation">{</span>
    <span class="token keyword">return</span> observable
               <span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">)</span>
               <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>aboveThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You might be tempted just to call that action eg. <code>tempTooHigh(myObservableTemps)</code>, but <strong>don’t</strong>, there’s a better way:</p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> myObservableTemps
                    <span class="token punctuation">.</span><span class="token function">complexPipe</span><span class="token punctuation">(</span>tempTooHigh<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Why is this better? It is much more obvious what order the chain is processing in.</p>
<h3 id="option-2-convert-to-pipe---better">Option 2: Convert to pipe - Better</h3>
<pre class=" language-javascript"><code class="prism  language-javascript">sequence<span class="token operator">&lt;</span>action<span class="token operator">&lt;</span>action<span class="token operator">&lt;</span>IObserver<span class="token operator">&gt;</span> returns ISubscription<span class="token operator">&gt;</span> <span class="token operator">&gt;</span> returns
                                             action<span class="token operator">&lt;</span>IObserver<span class="token operator">&gt;</span> returns ISubscription<span class="token operator">&gt;</span> 
    tempTooHigh <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token punctuation">[</span>Pluck<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Filter<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>outsideThreshold<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> myObservableTemps
   <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>tempTooHigh<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="option-3--create-a-custom-pipe---best">Option 3:  Create a custom pipe - Best</h3>
<pre class=" language-javascript"><code class="prism  language-javascript">event TempTooHigh <span class="token punctuation">{</span>    
    <span class="token keyword">static</span> action <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> returns action<span class="token operator">&lt;</span>action<span class="token operator">&lt;</span>IObserver<span class="token operator">&gt;</span> returns ISubscription<span class="token operator">&gt;</span>
                                             returns action<span class="token operator">&lt;</span>IObserver<span class="token operator">&gt;</span> returns ISubscription <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Pipe<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            Pluck<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            Filter<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>outsideThreshold<span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
    
IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> myObservableTemps
   <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">[</span>TempTooHigh<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>

IObservable o <span class="token punctuation">:</span><span class="token operator">=</span> myObservableTemps
   <span class="token punctuation">.</span><span class="token keyword">let</span><span class="token punctuation">(</span>TempTooHigh<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="a-idgotchasagotchas"><a id="gotchas"></a>Gotchas</h2>
<h3 id="a-idgotcha-multiple-subscribersamultiple-subscribers"><a id="gotcha-multiple-subscribers"></a>Multiple Subscribers</h3>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable sharedObs <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s1 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0,1,2,3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 0,1,2,3... What?</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Why?</strong><br>
Each subscriber creates it’s own chain through to the source. In this case that means that each subscriber get it’s own interval.<br>
<strong>Solution</strong><br>
Use <a href="#multicasting">Share</a></p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable sharedObs <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s1 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output: 0,1,2,3...</span>
on <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    
    ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Output: 2,3...</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="a-idgotcha-subscribe-onapublishshare-and-subscribeon"><a id="gotcha-subscribe-on"></a>Publish/Share and SubscribeOn</h3>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable sharedObs <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ISubscription s1 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribeOnNew</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output on "Main Context": 0,1,2,3...</span>
<span class="token comment">// Output on "New Context": Nothing.... What?!       </span>
</code></pre>
<p><strong>Why?</strong><br>
Publish and Share both store information about their current subscribers and upstream connections. When the entire chain is moved onto another context this information is copied and the operators no longer function correctly.<br>
<em><strong>Solution</strong></em> - <code>.decouple()</code></p>
<pre class=" language-javascript"><code class="prism  language-javascript">IObservable sharedObs <span class="token punctuation">:</span><span class="token operator">=</span> Observable<span class="token punctuation">.</span><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
                                   <span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ISubscription s1 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ISubscription s2 <span class="token punctuation">:</span><span class="token operator">=</span> sharedObs<span class="token punctuation">.</span><span class="token function">decouple</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Note: observeOn may be a better solution</span>
                           <span class="token punctuation">.</span><span class="token function">subscribeOnNew</span><span class="token punctuation">(</span>Subscriber<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onNext</span><span class="token punctuation">(</span>printValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Output on "Main Context": 0,1,2,3...</span>
<span class="token comment">// Output on "New Context": 0,1,2,3...</span>
</code></pre>
<p>This helps by ‘decoupling’ the upstream and the downstream. When subscribeOn is called only the downstream is copied. This means that only part of the chain is running on a separate context. A better solution might be to use ObserveOn instead of subscribeOn.</p>
<h2 id="a-idotherahelp-and-other-resources"><a id="other"></a>Help and Other Resources</h2>
<p><strong><a href="http://reactivex.io/">ReactiveX Website</a></strong> - A great place to get info about the background to the framework.<br>
<strong><a href="http://reactivex.io/documentation/operators.html#tree">Decision Tree Of Observables</a></strong> - Don’t know which operator to use? Follow this<br>
<strong><a href="http://rxmarbles.com/">RxMarbles</a></strong> - An interactive tool to play with observable operators</p>

    </div>
  </div>
</body>

</html>
